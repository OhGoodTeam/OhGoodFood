<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.ohgoodfood.dao.CommonMapper">

	<!-- 유저 로그인 입력 정보 검증 -->
	<select id="loginAccount" resultType="kr.co.ohgoodfood.dto.Account">
		SELECT * FROM Account
		WHERE user_id=#{id}
		AND user_pwd=#{pwd}
	</select>
	
	<!-- 가게 사장 로그인 입력 정보 검증 -->
	<select id="loginStore" resultType="kr.co.ohgoodfood.dto.Store">
		SELECT * FROM Store
		WHERE store_id=#{id}
		AND store_pwd=#{pwd}
	</select>
	
	<!-- 카카오 객체 검색 -->
	<select id="findById" resultType="kr.co.ohgoodfood.dto.Account">
        SELECT * FROM Account WHERE user_id = #{userId}
    </select>
    
    <!-- 카카오 회원 가입 -->
    <insert id="insertKakaoUser">
    INSERT INTO Account (
        user_id, user_name, user_nickname, user_pwd, phone_number, join_date, user_status, location_agreement
    ) VALUES (
        #{id}, #{nickname}, #{nickname}, 'kakao_login', #{email}, NOW(), 'Y', 'Y'
    )
    </insert>
    
    <!-- 카카오 유저 정보 업데이트 -->
    <update id="updateKakaoUser" parameterType="map">
	    UPDATE Account
	    SET user_name = #{nickname},
	        user_nickname = #{nickname},
	        phone_number = #{email}
	    WHERE user_id = #{id}
	</update>

</mapper>